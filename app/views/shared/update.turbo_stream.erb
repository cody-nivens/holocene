<% object_name ||= object.class.name.underscore %>
<% path_name ||= object_name.pluralize %>
<% short ||= nil %>
<% part ||= 'show' %>
<% long ||= nil %>
<%= turbo_stream.replace "#{dom_id object}" do %>
  <%= content_tag "turbo-frame", id: "#{dom_id object}" do %>
    <% if short.kind_of?(TrueClass) or short == "true" %>
      <%= render partial: "#{path_name}/#{object_name}_item", locals: { "#{object_name}":  object } %>
    <% else %>
      <%= render partial: "#{path_name}/#{object_name}", locals: { "#{object_name}":  object } %>
    <% end %>
    <% if lookup_context.exists?("sub_objects", [ "#{path_name}" ], true) %>
      <%= render partial: "#{path_name}/sub_objects", locals: { "#{object_name}": object } %>
    <% end %>
  <% end %>
<% end %>
<% if short.blank? %>
  <%= turbo_stream.replace "header"  do %>
    <%= content_tag :div, id: "header", class: 'block' do %>
      <%== render partial: "#{path_name}/#{part.nil? || part == 'show' ? '' : "#{part}_"}header", locals: { "#{object_name}": object} %>
    <% end %>
  <% end %>
  <%= turbo_stream.replace "side_controls" do %>
    <%= content_tag :div, id: "side_controls", class: "block" do %>
      <% if part == 'show' %>
        <%== render partial: "#{path_name}/side_controls", locals: { "#{object_name}": object, long: long } %>
      <% else %>
        <%# if lookup_context.exists?("#{part.nil? ? '' : "#{part}"}_sides", [ "#{path_name}" ], true) %>
        <%== render partial: "#{path_name}/#{part}_sides", locals: { "#{object_name}": object, long: long } %>
        <%# elsif lookup_context.exists?("_side_controls", [ "#{path_name}" ], true) %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
<%= render partial: "shared/send_flash" %>
